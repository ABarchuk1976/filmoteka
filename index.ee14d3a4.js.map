{"mappings":"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","sources":["src/index.js","src/js/header-main.js","src/js/open-model.js"],"sourcesContent":["import './js/constants.js';\nimport './js/common.js';\nimport './js/header-main.js';\nimport './js/open-model.js';\nimport './js/modal-film.js';\nimport './js/modal-team.js';\nimport './js/trailer.js';\nimport './js/btn-scroll.js';\nimport './js/spinner.js';\nimport './js/local-storage.js';\n","import axios from 'axios';\n\nimport { API, KEY, TRENDING, MEDIA_TYPE, TIME_WINDOW } from './constants.js';\nimport spinnerToggle from './spinner.js';\nimport { renderPagination, renderFilmCards, goUp } from './common.js';\n\nconst galleryRef = document.querySelector('.js-gallery');\nconst pagRef = document.querySelector('.js-pagination');\nconst warningRef = document.querySelector('.header__warning');\nconst inputRef = document.querySelector('.header__input');\nconst formRef = document.querySelector('.header__form');\n\nlet currentQuery = '';\nlet currentPage = 1;\n// 1 - do popular, 0 - do search\nlet currentProcess = 1;\n\nexport function showMessage(message) {\n  warningRef.insertAdjacentHTML(\n    'beforeend',\n    `<div class=\"header__warning-message\">${message}</div>`\n  );\n\n  setTimeout(() => {\n    warningRef.innerHTML = '';\n  }, 4000);\n}\n\nasync function getAPIData(page, process) {\n  try {\n    let searchPath = '';\n    if (process) {\n      searchPath = `${API}${TRENDING}/${MEDIA_TYPE}/${TIME_WINDOW}?`;\n      searchPath += new URLSearchParams({\n        api_key: KEY,\n        page,\n        include_adult: false,\n      });\n    } else {\n      searchPath = `${API}/search/${MEDIA_TYPE}?`;\n      searchPath += new URLSearchParams({\n        api_key: KEY,\n        language: 'en-US',\n        query: inputRef.value.trim().toLowerCase(),\n        page,\n        include_adult: false,\n      });\n    }\n\n    const response = await axios.get(searchPath);\n\n    if (response.status !== 200) {\n      throw new Error('Service is temporarily unavailable.');\n    }\n\n    return response.data;\n  } catch (error) {\n    showMessage(error.message);\n  }\n}\n\nfunction processingAPIData(pageAPI, process) {\n  spinnerToggle();\n  setTimeout(\n    () =>\n      getAPIData(pageAPI, process)\n        .then(({ page, results, total_pages: pages }) => {\n          renderFilmCards(results, galleryRef);\n          renderPagination(page, pages, pagRef);\n          if (!pages)\n            throw new Error(\n              `Search result \"${currentQuery}\" not successful. Enter an another movie name.`\n            );\n        })\n        .catch(error => showMessage(error.message))\n        .finally(spinnerToggle()),\n    200\n  );\n}\n\nwindow.addEventListener('load', () => {\n  processingAPIData(currentPage, currentProcess);\n});\n\npagRef.addEventListener('click', onClickPagination);\n\nfunction onClickPagination(evt) {\n  const target = evt.target;\n\n  if (target.textContent === '...' || target.tagName !== 'LI') return;\n\n  if (target.classList.contains('js-pagination__arrow-left')) currentPage -= 1;\n\n  if (target.classList.contains('js-pagination__arrow-right')) currentPage += 1;\n\n  if (target.classList.contains('js-pagination__button'))\n    currentPage = Number(target.textContent);\n\n  processingAPIData(currentPage, currentProcess);\n\n  goUp();\n}\n\nformRef.addEventListener('submit', evt => {\n  currentProcess = 0;\n  currentPage = 1;\n\n  evt.preventDefault();\n  currentQuery = evt.currentTarget.elements.searchQuery.value\n    .trim()\n    .toLowerCase();\n\n  if (!currentQuery) {\n    const message = 'Search query is empty. Rendering the popular movies.';\n\n    showMessage(message);\n    galleryRef.innerHTML = '';\n    currentProcess = 1;\n  }\n\n  processingAPIData(currentPage, currentProcess);\n});\n\ninputRef.addEventListener('input', evt => {\n  const query = evt.target;\n  const inputBtnClearRef = document.querySelector('.header__btn-clear');\n\n  if (query.value.length) {\n    inputBtnClearRef.classList.remove('hidden');\n  } else {\n    inputBtnClearRef.classList.add('hidden');\n    inputBtnClearRef.removeEventListener('click', onClearInput);\n  }\n\n  inputBtnClearRef.addEventListener('click', onClearInput);\n\n  function onClearInput() {\n    query.value = '';\n    inputBtnClearRef.classList.add('hidden');\n    inputBtnClearRef.removeEventListener('click', onClearInput);\n  }\n});\n","import { getStore, setStore, removeStore } from './local-storage.js';\nimport ModalFilm from './modal-film';\nimport {\n  handleBackButtonClick,\n  trailerButtonRef,\n  handleTrailerButtonClick,\n} from './trailer';\nimport { changeStore, getFilmData } from './common.js';\n\nconst gallery = document.querySelector('.js-gallery');\nconst closeBtn = document.querySelector('[data-modal-close]');\nconst btnWrapperRef = document.querySelector('.btn__wrapper');\n// const btnWatched = document.querySelector('.btn_watched');\n// const btnQueue = document.querySelector('.btn_queue');\n\nconst modalFilm = new ModalFilm();\n\ngallery.addEventListener('click', onOpenModal);\ncloseBtn.addEventListener('click', onCloseModal);\nwindow.addEventListener('keydown', onCloseModalEsc);\n\nfunction onOverlayClose(event) {\n  if (!event.target.closest('.modal') && event.target.closest('.backdrop')) {\n    onCloseModal();\n  }\n}\ndocument.addEventListener('click', onOverlayClose);\n\nfunction onOpenModal(evt) {\n  const { id, nodeName, name } = evt.target;\n  evt.preventDefault();\n  trailerButtonRef.addEventListener('click', handleTrailerButtonClick);\n\n  if (nodeName !== 'IMG') return;\n\n  const dataCurrentFilm = getFilmData(id);\n\n  modalFilm.modifyDataFilm(dataCurrentFilm);\n  modalFilm.open();\n\n  btnWrapperRef.addEventListener('click', onBtnClick);\n}\n\nfunction onBtnClick(evt) {\n  const { nodeName, name: key } = evt.target;\n  if (nodeName !== 'BUTTON') return;\n  changeStore(key);\n  modalFilm.rerenderBtnWrapper();\n}\n\ncloseBtn.addEventListener('click', onCloseModal);\nwindow.addEventListener('keydown', onCloseModalEsc);\n\nfunction onCloseModal() {\n  const iframeContainer = document.querySelector('.iframe-container');\n  const trailerContainer = document.querySelector('.film__info-wrapper');\n\n  handleBackButtonClick(iframeContainer, trailerContainer);\n\n  modalFilm.close();\n\n  closeBtn.removeEventListener('click', onCloseModal);\n  trailerButtonRef.removeEventListener('click', handleTrailerButtonClick);\n  window.removeEventListener('keydown', onCloseModalEsc);\n}\n\nfunction onCloseModalEsc(evt) {\n  if (evt.code === 'Escape') {\n    modalFilm.close();\n\n    closeBtn.removeEventListener('click', onCloseModal);\n    window.removeEventListener('keydown', onCloseModalEsc);\n  }\n}\n\n////////////// checks for button /////////////////\n\nfunction checkWatchedStorage(currentFilm) {\n  try {\n    const getWatchedFromStorage = localStorage.getItem('WatchedMovies');\n    const getWatchedArray = JSON.parse(getWatchedFromStorage);\n    const checkWatchedStorage = getWatchedArray.find(\n      option => option.id === currentFilm.id\n    );\n    if (checkWatchedStorage) {\n      btnWatched.classList.replace('watched_send', 'watched_remove');\n      btnWatched.textContent = 'REMOVE FROM WATCHED';\n    } else {\n      btnWatched.classList.replace('watched_remove', 'watched_send');\n      btnWatched.textContent = 'ADD TO WATCHED';\n    }\n  } catch (error) {\n    // console.error('Get state error: ', error.message);\n    btnWatched.classList.replace('watched_remove', 'watched_send');\n  }\n}\n\nfunction checkQueueStorage(currentFilm) {\n  try {\n    const getQueueFromStorage = localStorage.getItem('QueueMovies');\n    const getQueueArray = JSON.parse(getQueueFromStorage);\n    const checkQueueStorage = getQueueArray.find(\n      option => option.id === currentFilm.id\n    );\n    if (checkQueueStorage) {\n      btnQueue.classList.replace('queue_send', 'queue_remove');\n      btnQueue.textContent = 'REMOVE FROM QUEUE';\n    } else {\n      btnQueue.classList.replace('queue_remove', 'queue_send');\n      btnQueue.textContent = 'ADD TO QUEUE';\n    }\n  } catch (error) {\n    // console.error('Get state error: ', error.message);\n    btnQueue.classList.replace('queue_remove', 'queue_send');\n  }\n}\n"],"names":["parcelRequire","$2shzp","$8e6132805e0f90fb$var$galleryRef","document","querySelector","$8e6132805e0f90fb$var$pagRef","$8e6132805e0f90fb$var$warningRef","$8e6132805e0f90fb$var$inputRef","$8e6132805e0f90fb$var$formRef","$8e6132805e0f90fb$var$currentQuery","$8e6132805e0f90fb$var$currentPage","$8e6132805e0f90fb$var$currentProcess","$8e6132805e0f90fb$export$787f5d117f138d13","message","insertAdjacentHTML","setTimeout","innerHTML","$8e6132805e0f90fb$var$processingAPIData","pageAPI","process","$04jNI","default","async","page","searchPath","$8G1wF","API","TRENDING","MEDIA_TYPE","TIME_WINDOW","URLSearchParams","api_key","KEY","include_adult","language","query","value","trim","toLowerCase","response","get","status","Error","data","error","$8e6132805e0f90fb$var$getAPIData","then","results","total_pages","pages","$7EEHk","renderFilmCards","renderPagination","catch","finally","window","addEventListener","evt","target","textContent","tagName","classList","contains","Number","goUp","preventDefault","currentTarget","elements","searchQuery","inputBtnClearRef","onClearInput","add","removeEventListener","length","remove","$95c314e50c7458b5$var$gallery","$95c314e50c7458b5$var$closeBtn","$95c314e50c7458b5$var$btnWrapperRef","$95c314e50c7458b5$var$modalFilm","$fQE3M","$95c314e50c7458b5$var$onBtnClick","nodeName","name","key","changeStore","rerenderBtnWrapper","$95c314e50c7458b5$var$onCloseModal","iframeContainer","trailerContainer","$37v9V","handleBackButtonClick","close","trailerButtonRef","handleTrailerButtonClick","$95c314e50c7458b5$var$onCloseModalEsc","code","id","dataCurrentFilm","getFilmData","modifyDataFilm","open","event","closest"],"version":3,"file":"index.ee14d3a4.js.map"}