{"mappings":"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","sources":["src/js/open-model.js","src/js/common.js","src/js/header-main.js"],"sourcesContent":["import * as storageLocal from './local-storage.js';\nimport ModalFilm from './modal-film';\nimport { handleBackButtonClick, trailerButtonRef,  handleTrailerButtonClick} from './trailer';\n\nimport { sendWatchedToStorage, sendQueueToStorage} from \"./local-storage-set\";\n\nconst refs = {\n  gallery: document.querySelector('.js-gallery'),\n  closeBtn: document.querySelector('[data-modal-close]'),\n  btnWatched: document.querySelector(\".btn_watched\"),\n  btnQueue: document.querySelector(\".btn_queue\"),\n};\n\nconst modalFilm = new ModalFilm();\n\nrefs.gallery.addEventListener('click', onOpenModal);\nrefs.closeBtn.addEventListener('click', onCloseModal);\nwindow.addEventListener('keydown', onCloseModalEsc);  \n\nfunction onOverlayClose(event) {\n  if (!event.target.closest(\".modal\") && event.target.closest('.backdrop')) {\n      onCloseModal();\n  }\n}\ndocument.addEventListener(\"click\", onOverlayClose)\n\nfunction onOpenModal(e) {\n  e.preventDefault();\n  trailerButtonRef.addEventListener('click', handleTrailerButtonClick);\n\n  if (e.target.nodeName !== 'IMG') return;\n\n  const dataCurentFilm = getFilmData(e.target.id);\n\n  modalFilm.modifyDataFilm(dataCurentFilm);\n  modalFilm.open();\n\n///// for local-storage and button /////////\n  refs.btnWatched.addEventListener(\"click\", onWatchedBtnClick)\n  refs.btnQueue.addEventListener(\"click\", onQueueBtnClick)\n\n  localStorage.setItem(\"CurrentFilm\", JSON.stringify(dataCurentFilm))\n  \n  checkWatchedStorage(dataCurentFilm)\n  if (refs.btnWatched.classList.contains(\"watched_remove\")) {\n    refs.btnWatched.textContent = 'REMOVE FROM WATCHED'} \n  else if(refs.btnWatched.classList.contains(\"watched_send\")){\n    refs.btnWatched.textContent = 'ADD TO WATCHED'\n  }\n\n  checkQueueStorage(dataCurentFilm)\n  if (refs.btnQueue.classList.contains(\"queue_remove\")) {\n      refs.btnQueue.textContent = 'REMOVE FROM QUEUE'}\n  else if (refs.btnWatched.classList.contains(\"queue_send\")){\n    refs.btnQueue.textContent = 'ADD TO QUEUE'\n  }\n    \n  function onWatchedBtnClick() {\n    if (refs.btnWatched.classList.contains(\"watched_send\")) {\n      refs.btnWatched.textContent = 'REMOVE FROM WATCHED'\n      refs.btnWatched.classList.replace(\"watched_send\", \"watched_remove\")\n\n      sendWatchedToStorage()\n\n    } else if (refs.btnWatched.classList.contains(\"watched_remove\")) {\n      refs.btnWatched.textContent = 'ADD TO WATCHED'  \n      refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n\n      removeWatchedFilm(dataCurentFilm)\n    }\n      \n    refs.btnWatched.textContent = 'ADD TO WATCHED' \n    refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")  \n  }\n \n  function removeWatchedFilm(currentFilm) {\n      try {\n        const getWatchedFromStorage = localStorage.getItem(\"WatchedMovies\")\n        const getWatchedArray = JSON.parse(getWatchedFromStorage)\n\n        const watchedFilmIndex = getWatchedArray.findIndex(value => value.id === currentFilm.id);\n        getWatchedArray.splice(watchedFilmIndex, 1)\n        localStorage.setItem(\"WatchedMovies\", JSON.stringify(getWatchedArray))\n      } catch (error) {\n      // console.error('Get state error: ', error.message);\n    }\n}\n  \n  function onQueueBtnClick() {\n    if (refs.btnQueue.classList.contains(\"queue_send\")) {\n      refs.btnQueue.textContent = 'REMOVE FROM QUEUE'\n      refs.btnQueue.classList.replace(\"queue_send\", \"queue_remove\")\n\n      sendQueueToStorage()\n    } else if (refs.btnQueue.classList.contains(\"queue_remove\")) {\n      refs.btnQueue.textContent = 'ADD TO QUEUE'  \n      refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n\n      removeQueueFilm(dataCurentFilm)\n    }\n\n    refs.btnQueue.textContent = 'ADD TO QUEUE'  \n    refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n  }\n\n  function removeQueueFilm(currentFilm) {\n      try {\n        const getQueueFromStorage = localStorage.getItem(\"QueueMovies\")\n        const getQueueArray = JSON.parse(getQueueFromStorage)\n\n        const queueFilmIndex = getQueueArray.findIndex(value => value.id === currentFilm.id);\n        getQueueArray.splice(queueFilmIndex, 1)\n        localStorage.setItem(\"QueueMovies\", JSON.stringify(getQueueArray))\n\n    } catch (error) {\n      // console.error('Get state error: ', error.message);\n    }\n  }\n///////////////////end of local-storage ///////////\n\n  refs.closeBtn.addEventListener('click', onCloseModal);\n  window.addEventListener('keydown', onCloseModalEsc);\n}\n\nfunction onCloseModal() {\n  const iframeContainer = document.querySelector('.iframe-container');\n  const trailerContainer = document.querySelector('.film__info-wrapper');\n  handleBackButtonClick(iframeContainer, trailerContainer);\n  modalFilm.close();\n  refs.closeBtn.removeEventListener('click', onCloseModal);\n  trailerButtonRef.removeEventListener('click', handleTrailerButtonClick);\n  window.removeEventListener('keydown', onCloseModalEsc);\n\n\n  //////////Примусове перезавантаження сторінки /////////////////////////////////\n  // window.location.reload()\n}\n\nfunction onCloseModalEsc(e) {\n  if (e.code === 'Escape') {\n    modalFilm.close();\n\n    refs.closeBtn.removeEventListener('click', onCloseModal);\n    window.removeEventListener('keydown', onCloseModalEsc);\n  }\n}\n\nfunction getFilmData(filmId) {\n  const filmList = storageLocal.load('film-current-page');\n  return filmList.find(film => film.id === Number(filmId));\n}\n\n////////////// checks for button /////////////////\n\nfunction checkWatchedStorage(currentFilm) {\n  try {\n    const getWatchedFromStorage = localStorage.getItem(\"WatchedMovies\")\n    const getWatchedArray = JSON.parse(getWatchedFromStorage)\n    const checkWatchedStorage = getWatchedArray.find(option => option.id === currentFilm.id);\n        if (checkWatchedStorage) {\n          refs.btnWatched.classList.replace(\"watched_send\", \"watched_remove\")\n          refs.btnWatched.textContent = 'REMOVE FROM WATCHED'\n        } else {\n          refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n          refs.btnWatched.textContent = 'ADD TO WATCHED'\n        }\n    } catch (error) {\n      // console.error('Get state error: ', error.message);\n      refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n    }\n}\n\nfunction checkQueueStorage(currentFilm) {\n  try {\n    const getQueueFromStorage = localStorage.getItem(\"QueueMovies\")\n    const getQueueArray = JSON.parse(getQueueFromStorage)\n    const checkQueueStorage = getQueueArray.find(option => option.id === currentFilm.id);\n        if (checkQueueStorage) {\n          refs.btnQueue.classList.replace(\"queue_send\", \"queue_remove\")\n          refs.btnQueue.textContent = 'REMOVE FROM QUEUE'\n        } else {\n          refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n          refs.btnQueue.textContent = 'ADD TO QUEUE'\n        }\n    } catch (error) {\n      // console.error('Get state error: ', error.message);\n      refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n    }\n}","import spinnerToggle from './spinner.js';\nimport * as storageLocal from './local-storage.js';\nconst FILM_CURRENT_PAGE = 'film-current-page';\nimport axios from 'axios';\nimport {\n  API,\n  KEY,\n  TRENDING,\n  MEDIA_TYPE,\n  TIME_WINDOW,\n  IMG_PATH,\n  SMALL_SIZE,\n  NO_IMAGE,\n} from './constants.js';\nimport { getGenre } from './modal-film';\n\nconst LEFT_ARROW = '&#8592;';\nconst RIGHT_ARROW = '&#8594;';\n\nconst searchQuery = document.querySelector('.header__input');\n\nexport function renderPagination(page, pages, ref) {\n  let prevPage = page - 1;\n  let twoPrevPage = page - 2;\n  let nextPage = page + 1;\n  let twoNextPage = page + 2;\n  let markup = '';\n\n  if (!page || page > pages) return;\n\n  if (page > 1)\n    markup += `<li class=\"js-pagination__arrow-left\">${LEFT_ARROW}</li>`;\n\n  if (page > 1)\n    markup += `<li class=\"js-pagination__button js-pagination__button-end\">1</li>`;\n\n  if (page > 4) markup += `<li class=\"js-pagination__points\">...</li>`;\n\n  if (page > 3)\n    markup += `<li class=\"js-pagination__button\">${twoPrevPage}</li>`;\n\n  if (page > 2) markup += `<li class=\"js-pagination__button\">${prevPage}</li>`;\n\n  markup += `<li class=\"js-pagination__button js-pagination__button-current\">${page}</li>`;\n\n  if (page + 1 < pages)\n    markup += `<li class=\"js-pagination__button\">${nextPage}</li>`;\n\n  if (page + 2 < pages)\n    markup += `<li class=\"js-pagination__button\">${twoNextPage}</li>`;\n\n  if (page + 4 < pages) markup += `<li class=\"js-pagination__points\">...</li>`;\n\n  if (page < pages)\n    markup += `<li class=\"js-pagination__button js-pagination__button-end\">${pages}</li>`;\n\n  if (page < pages)\n    markup += `<li class=\"js-pagination__arrow-right\">${RIGHT_ARROW}</li>`;\n\n  ref.innerHTML = markup;\n}\n\nexport async function getAPIData(page, now) {\n  try {\n    let searchPath = '';\n    if (now) {\n      searchPath = `${API}${TRENDING}/${MEDIA_TYPE}/${TIME_WINDOW}?`;\n      searchPath += new URLSearchParams({\n        api_key: KEY,\n        page: page,\n        include_adult: false,\n      });\n    } else {\n      searchPath = `${API}/search/${MEDIA_TYPE}?`;\n      searchPath += new URLSearchParams({\n        api_key: KEY,\n        language: 'en-US',\n        query: searchQuery.value.trim().toLowerCase(),\n        page: page,\n        include_adult: false,\n      });\n    }\n\n    const response = await axios.get(searchPath);\n\n    if (response.status !== 200) {\n      throw new Error(response.status);\n    }\n    return response.data;\n  } catch (error) {\n    console.log(error.message);\n  }\n}\n\nexport function renderFilmCards(data, ref) {\n  let markup = data\n    .map(({ id, poster_path, genre_ids, title, release_date }) => {\n      let genresStr = getGenre(genre_ids);\n      let year = !release_date ? '' : release_date.substring(0, 4);\n      if (genresStr && year) genresStr += ' | ';\n      if (!title) title = 'no information';\n\n      let smallImg = !!poster_path\n        ? IMG_PATH + SMALL_SIZE + poster_path\n        : NO_IMAGE;\n\n      return `\n      <li class=\"film-card\">\n         \t<a href=\"#\" class=\"film-card__link\">\n            <img\n              class=\"film-card__film-img\"\n              src=\"${smallImg}\"\n              alt=\"${title}\"\n              id=\"${id}\"\n            />\n            <h3 class=\"film-card__film-name\">${title}</h3>\n            <p class=\"film-card__genre\">${genresStr}${year}</p>\n          </a>\n        </li>\n\t\t\t\t\t\t\t`;\n    })\n    .join('');\n\n  ref.innerHTML = markup;\n\n  // запис в локальне сховище\n  storageLocal.save(FILM_CURRENT_PAGE, [...data]);\n  //\n}\n","import axios from 'axios';\nimport spinnerToggle from './spinner.js';\n\nimport {\n  renderPagination,\n  genresList,\n  getAPIData,\n  renderFilmCards,\n} from './common.js';\n\nimport {\n  KEY,\n  MEDIA_TYPE,\n  API,\n  TIME_WINDOW,\n  TRENDING,\n  IMG_PATH,\n  SMALL_SIZE,\n  NO_IMAGE,\n  ADULT,\n} from './constants.js';\n\n// імпорт файлу сховища та запис в змінну ключа\nimport * as storageLocal from './local-storage.js';\nconst FILM_CURRENT_PAGE = 'film-current-page';\n//\n\nconst galleryRef = document.querySelector('.js-gallery');\nconst pagRef = document.querySelector('.js-pagination');\nconst warningRef = document.querySelector('.header__warning');\nconst inputRef = document.querySelector('.header__input');\nconst formRef = document.querySelector('.header__form');\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet nowAt = 1;\n\nwindow.addEventListener('load', () => {\n  galleryRef.innerHTML = '';\n\n  currentPage = 1;\n  nowAt = 1;\n\n  getAPIData(currentPage, nowAt)\n    .then(({ page, results, total_pages: pages }) => {\n      renderFilmCards(results, galleryRef);\n      renderPagination(page, pages, pagRef);\n    })\n    .catch(error => {\n      warningRef.insertAdjacentHTML(\n        'beforeend',\n        `<div class=\"header__warning-message\">Service is temporarily unavailable.</div>`\n      );\n\n      setTimeout(() => {\n        warningRef.innerHTML = '';\n      }, 4000);\n    });\n});\n\nfunction emptyQueryOrNoResults() {\n  warningRef.insertAdjacentHTML(\n    'beforeend',\n    `<div class=\"header__warning-message\">Search result not successful. Enter the correct movie name.</div>`\n  );\n\n  setTimeout(() => {\n    warningRef.innerHTML = '';\n  }, 4000);\n\n  galleryRef.innerHTML = '';\n\n  nowAt = 1;\n  currentPage = 1;\n\n  getAPIData(currentPage, nowAt)\n    .then(({ page, results, total_pages: pages }) => {\n      renderFilmCards(results, galleryRef);\n      renderPagination(page, pages, pagRef);\n    })\n    .catch(() => {\n      warningRef.insertAdjacentHTML(\n        'beforeend',\n        `<div class=\"header__warning-message\">Service is temporarily unavailable.</div>`\n      );\n\n      setTimeout(() => {\n        warningRef.innerHTML = '';\n      }, 4000);\n    });\n}\n\npagRef.addEventListener('click', onClickPagination);\n\nfunction onClickPagination(evt) {\n  const target = evt.target;\n\n  if (target.textContent === '...' || target.tagName !== 'LI') return;\n\n  if (target.classList.contains('js-pagination__arrow-left')) currentPage -= 1;\n\n  if (target.classList.contains('js-pagination__arrow-right')) currentPage += 1;\n\n  if (target.classList.contains('js-pagination__button'))\n    currentPage = Number(target.textContent);\n\n  getAPIData(currentPage, nowAt)\n    .then(({ page, results, total_pages: pages }) => {\n      renderFilmCards(results, galleryRef);\n      renderPagination(page, pages, pagRef);\n    })\n    .catch(() => {\n      warningRef.insertAdjacentHTML(\n        'beforeend',\n        `<div class=\"header__warning-message\">Service is temporarily unavailable.</div>`\n      );\n\n      setTimeout(() => {\n        warningRef.innerHTML = '';\n      }, 4000);\n    });\n}\n\nformRef.addEventListener('submit', evt => {\n  nowAt = 0;\n  currentPage = 1;\n\n  // spinnerToggle();\n  evt.preventDefault();\n  currentQuery = evt.currentTarget.elements.searchQuery.value\n    .trim()\n    .toLowerCase();\n\n  if (!currentQuery) {\n    emptyQueryOrNoResults();\n    return;\n  }\n\n  getAPIData(currentPage, nowAt)\n    .then(({ page, results, total_pages: pages }) => {\n      if (!pages) {\n        emptyQueryOrNoResults();\n        return;\n      }\n      renderFilmCards(results, galleryRef);\n      renderPagination(page, pages, pagRef);\n    })\n    .catch(error => {\n      warningRef.insertAdjacentHTML(\n        'beforeend',\n        `<div class=\"header__warning-message\">Service is temporarily unavailable.</div>`\n      );\n\n      setTimeout(() => {\n        warningRef.innerHTML = '';\n      }, 4000);\n    });\n});\n\ninputRef.addEventListener('input', evt => {\n  const query = evt.target;\n  const inputBtnClearRef = document.querySelector('.header__btn-clear');\n\n\tif (query.value.length) {\n\t\tinputBtnClearRef.classList.remove('hidden');\t\n\t}\n\telse {\n\t\tinputBtnClearRef.classList.add('hidden');\t\n\t\tinputBtnClearRef.removeEventListener('click', onClearInput);\n\t};\n\n\tinputBtnClearRef.addEventListener('click', onClearInput);\n\t\n\tfunction onClearInput(evt) {\n    query.value = '';\n\t\tinputBtnClearRef.classList.add('hidden');\t\n\t\tinputBtnClearRef.removeEventListener('click', onClearInput);\n  }\n});\n"],"names":["$4LMMA","parcelRequire","$fb09461e5f4fdf78$var$refs","gallery","document","querySelector","closeBtn","btnWatched","btnQueue","$fb09461e5f4fdf78$var$modalFilm","$73ES2","default","$fb09461e5f4fdf78$var$onCloseModal","iframeContainer","trailerContainer","$cDXQO","handleBackButtonClick","close","removeEventListener","trailerButtonRef","handleTrailerButtonClick","window","$fb09461e5f4fdf78$var$onCloseModalEsc","e","code","addEventListener","preventDefault","target","nodeName","dataCurentFilm","filmId","id","load","find","film","Number","modifyDataFilm","open","classList","contains","textContent","replace","$iDjs5","sendWatchedToStorage","currentFilm","getWatchedFromStorage","localStorage","getItem","getWatchedArray","JSON","parse","watchedFilmIndex","findIndex","value","splice","setItem","stringify","error","removeWatchedFilm","sendQueueToStorage","getQueueFromStorage","getQueueArray","queueFilmIndex","removeQueueFilm","option","$fb09461e5f4fdf78$var$checkWatchedStorage","$fb09461e5f4fdf78$var$checkQueueStorage","event","closest","$bpxeT","$b7383fa2020d36b2$var$searchQuery","$b7383fa2020d36b2$export$825408fbca4f2040","page","pages","ref","prevPage","twoPrevPage","nextPage","twoNextPage","markup","concat","innerHTML","$b7383fa2020d36b2$export$4c9e8e411b76d6f","now","$b7383fa2020d36b2$var$_getAPIData","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","searchPath","response","$4s6iC","API","TRENDING","MEDIA_TYPE","TIME_WINDOW","URLSearchParams","api_key","KEY","include_adult","language","query","trim","toLowerCase","$dIxxU","get","_ctx","sent","status","Error","data","console","log","t0","message","$b7383fa2020d36b2$export$e6243425577ce802","map","param","poster_path","genre_ids","title","release_date","genresStr","getGenre","year","substring","smallImg","IMG_PATH","SMALL_SIZE","NO_IMAGE","join","save","$8nrFW","$1441a966684ee2c8$var$galleryRef","$1441a966684ee2c8$var$pagRef","$1441a966684ee2c8$var$warningRef","$1441a966684ee2c8$var$inputRef","$1441a966684ee2c8$var$formRef","$1441a966684ee2c8$var$currentPage","$1441a966684ee2c8$var$nowAt","$1441a966684ee2c8$var$emptyQueryOrNoResults","insertAdjacentHTML","setTimeout","then","results","total_pages","catch","evt","tagName","currentTarget","elements","searchQuery","inputBtnClearRef","onClearInput","add","length","remove"],"version":3,"file":"index.b85ebe65.js.map"}