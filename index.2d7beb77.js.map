{"mappings":"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","sources":["src/index.js","src/js/header-main.js","src/js/open-model.js"],"sourcesContent":["import './js/constants.js';\nimport './js/common.js';\nimport './js/header-main.js';\nimport './js/open-model.js';\nimport './js/modal-film.js';\nimport './js/modal-team.js';\nimport './js/trailer.js';\nimport './js/btn-scroll.js';\nimport './js/spinner.js';\nimport './js/local-storage.js';\n","import axios from 'axios';\n\nimport { API, KEY, TRENDING, MEDIA_TYPE, TIME_WINDOW } from './constants.js';\nimport spinnerToggle from './spinner.js';\nimport { renderPagination, renderFilmCards, goUp } from './common.js';\n\nconst galleryRef = document.querySelector('.js-gallery');\nconst pagRef = document.querySelector('.js-pagination');\nconst warningRef = document.querySelector('.header__warning');\nconst inputRef = document.querySelector('.header__input');\nconst formRef = document.querySelector('.header__form');\n\nlet currentQuery = '';\nlet currentPage = 1;\n// 1 - do popular, 0 - do search\nlet currentProcess = 1;\n\nexport function showMessage(message) {\n  warningRef.insertAdjacentHTML(\n    'beforeend',\n    `<div class=\"header__warning-message\">${message}</div>`\n  );\n\n  setTimeout(() => {\n    warningRef.innerHTML = '';\n  }, 4000);\n}\n\nasync function getAPIData(page, process) {\n  try {\n    let searchPath = '';\n    if (process) {\n      searchPath = `${API}${TRENDING}/${MEDIA_TYPE}/${TIME_WINDOW}?`;\n      searchPath += new URLSearchParams({\n        api_key: KEY,\n        page,\n        include_adult: false,\n      });\n    } else {\n      searchPath = `${API}/search/${MEDIA_TYPE}?`;\n      searchPath += new URLSearchParams({\n        api_key: KEY,\n        language: 'en-US',\n        query: inputRef.value.trim().toLowerCase(),\n        page,\n        include_adult: false,\n      });\n    }\n\n    const response = await axios.get(searchPath);\n\n    if (response.status !== 200) {\n      throw new Error('Service is temporarily unavailable.');\n    }\n\n    return response.data;\n  } catch (error) {\n    showMessage(error.message);\n  }\n}\n\nfunction processingAPIData(pageAPI, process) {\n  spinnerToggle();\n  setTimeout(\n    () =>\n      getAPIData(pageAPI, process)\n        .then(({ page, results, total_pages: pages }) => {\n          renderFilmCards(results, galleryRef);\n          renderPagination(page, pages, pagRef);\n          if (!pages)\n            throw new Error(\n              `Search result \"${currentQuery}\" not successful. Enter an another movie name.`\n            );\n        })\n        .catch(error => showMessage(error.message))\n        .finally(spinnerToggle()),\n    200\n  );\n}\n\nwindow.addEventListener('load', () => {\n  processingAPIData(currentPage, currentProcess);\n});\n\npagRef.addEventListener('click', onClickPagination);\n\nfunction onClickPagination(evt) {\n  const target = evt.target;\n\n  if (target.textContent === '...' || target.tagName !== 'LI') return;\n\n  if (target.classList.contains('js-pagination__arrow-left')) currentPage -= 1;\n\n  if (target.classList.contains('js-pagination__arrow-right')) currentPage += 1;\n\n  if (target.classList.contains('js-pagination__button'))\n    currentPage = Number(target.textContent);\n\n  processingAPIData(currentPage, currentProcess);\n\n  goUp();\n}\n\nformRef.addEventListener('submit', evt => {\n  currentProcess = 0;\n  currentPage = 1;\n\n  evt.preventDefault();\n  currentQuery = evt.currentTarget.elements.searchQuery.value\n    .trim()\n    .toLowerCase();\n\n  if (!currentQuery) {\n    const message = 'Search query is empty. Rendering the popular movies.';\n\n    showMessage(message);\n    galleryRef.innerHTML = '';\n    currentProcess = 1;\n  }\n\n  processingAPIData(currentPage, currentProcess);\n});\n\ninputRef.addEventListener('input', evt => {\n  const query = evt.target;\n  const inputBtnClearRef = document.querySelector('.header__btn-clear');\n\n  if (query.value.length) {\n    inputBtnClearRef.classList.remove('hidden');\n  } else {\n    inputBtnClearRef.classList.add('hidden');\n    inputBtnClearRef.removeEventListener('click', onClearInput);\n  }\n\n  inputBtnClearRef.addEventListener('click', onClearInput);\n\n  function onClearInput() {\n    query.value = '';\n    inputBtnClearRef.classList.add('hidden');\n    inputBtnClearRef.removeEventListener('click', onClearInput);\n  }\n});\n","import { getStore, setStore, removeStore } from './local-storage.js';\nimport ModalFilm from './modal-film';\nimport {\n  handleBackButtonClick,\n  trailerButtonRef,\n  handleTrailerButtonClick,\n} from './trailer';\nimport { changeStore, getFilmData } from './common.js';\n\nconst gallery = document.querySelector('.js-gallery');\nconst closeBtn = document.querySelector('[data-modal-close]');\nconst btnWrapperRef = document.querySelector('.btn__wrapper');\n// const btnWatched = document.querySelector('.btn_watched');\n// const btnQueue = document.querySelector('.btn_queue');\n\nconst modalFilm = new ModalFilm();\n\ngallery.addEventListener('click', onOpenModal);\ncloseBtn.addEventListener('click', onCloseModal);\nwindow.addEventListener('keydown', onCloseModalEsc);\n\nfunction onOverlayClose(event) {\n  if (!event.target.closest('.modal') && event.target.closest('.backdrop')) {\n    onCloseModal();\n  }\n}\ndocument.addEventListener('click', onOverlayClose);\n\nfunction onOpenModal(evt) {\n  const { id, nodeName, name } = evt.target;\n  evt.preventDefault();\n  trailerButtonRef.addEventListener('click', handleTrailerButtonClick);\n\n  if (nodeName !== 'IMG') return;\n\n  const dataCurrentFilm = getFilmData(id);\n\n  modalFilm.modifyDataFilm(dataCurrentFilm);\n  modalFilm.open();\n\n  btnWrapperRef.addEventListener('click', onBtnClick);\n\n  function onBtnClick(evt) {\n    const { nodeName, name: key } = evt.target;\n    if (nodeName !== 'BUTTON') return;\n    changeStore(key);\n    modalFilm.rerenderBtnWrapper();\n  }\n  ///////////////////end of local-storage ///////////\n\n  closeBtn.addEventListener('click', onCloseModal);\n  window.addEventListener('keydown', onCloseModalEsc);\n}\n\nfunction onCloseModal() {\n  const iframeContainer = document.querySelector('.iframe-container');\n  const trailerContainer = document.querySelector('.film__info-wrapper');\n\n  handleBackButtonClick(iframeContainer, trailerContainer);\n\n  modalFilm.close();\n\n  closeBtn.removeEventListener('click', onCloseModal);\n  trailerButtonRef.removeEventListener('click', handleTrailerButtonClick);\n  window.removeEventListener('keydown', onCloseModalEsc);\n}\n\nfunction onCloseModalEsc(evt) {\n  if (evt.code === 'Escape') {\n    modalFilm.close();\n\n    closeBtn.removeEventListener('click', onCloseModal);\n    window.removeEventListener('keydown', onCloseModalEsc);\n  }\n}\n\n////////////// checks for button /////////////////\n\nfunction checkWatchedStorage(currentFilm) {\n  try {\n    const getWatchedFromStorage = localStorage.getItem('WatchedMovies');\n    const getWatchedArray = JSON.parse(getWatchedFromStorage);\n    const checkWatchedStorage = getWatchedArray.find(\n      option => option.id === currentFilm.id\n    );\n    if (checkWatchedStorage) {\n      btnWatched.classList.replace('watched_send', 'watched_remove');\n      btnWatched.textContent = 'REMOVE FROM WATCHED';\n    } else {\n      btnWatched.classList.replace('watched_remove', 'watched_send');\n      btnWatched.textContent = 'ADD TO WATCHED';\n    }\n  } catch (error) {\n    // console.error('Get state error: ', error.message);\n    btnWatched.classList.replace('watched_remove', 'watched_send');\n  }\n}\n\nfunction checkQueueStorage(currentFilm) {\n  try {\n    const getQueueFromStorage = localStorage.getItem('QueueMovies');\n    const getQueueArray = JSON.parse(getQueueFromStorage);\n    const checkQueueStorage = getQueueArray.find(\n      option => option.id === currentFilm.id\n    );\n    if (checkQueueStorage) {\n      btnQueue.classList.replace('queue_send', 'queue_remove');\n      btnQueue.textContent = 'REMOVE FROM QUEUE';\n    } else {\n      btnQueue.classList.replace('queue_remove', 'queue_send');\n      btnQueue.textContent = 'ADD TO QUEUE';\n    }\n  } catch (error) {\n    // console.error('Get state error: ', error.message);\n    btnQueue.classList.replace('queue_remove', 'queue_send');\n  }\n}\n"],"names":["parcelRequire","$bpxeT","$1441a966684ee2c8$var$galleryRef","document","querySelector","$1441a966684ee2c8$var$pagRef","$1441a966684ee2c8$var$warningRef","$1441a966684ee2c8$var$inputRef","$1441a966684ee2c8$var$formRef","$1441a966684ee2c8$var$currentQuery","$1441a966684ee2c8$var$currentPage","$1441a966684ee2c8$var$currentProcess","$1441a966684ee2c8$export$787f5d117f138d13","message","insertAdjacentHTML","concat","setTimeout","innerHTML","$1441a966684ee2c8$var$_getAPIData","$parcel$interopDefault","$2TvXO","mark","_callee","page","process","searchPath","response","$4s6iC","API","TRENDING","MEDIA_TYPE","TIME_WINDOW","URLSearchParams","api_key","KEY","include_adult","language","query","value","trim","toLowerCase","$dIxxU","default","get","_ctx","sent","status","Error","data","t0","apply","this","arguments","$1441a966684ee2c8$var$processingAPIData","pageAPI","$j1lrD","$1441a966684ee2c8$var$getAPIData","then","param","results","pages","total_pages","$fJh0j","renderFilmCards","renderPagination","catch","error","finally","window","addEventListener","evt","target","textContent","tagName","classList","contains","Number","goUp","preventDefault","currentTarget","elements","searchQuery","inputBtnClearRef","onClearInput","add","removeEventListener","length","remove","$fb09461e5f4fdf78$var$gallery","$fb09461e5f4fdf78$var$closeBtn","$fb09461e5f4fdf78$var$btnWrapperRef","$fb09461e5f4fdf78$var$modalFilm","$73ES2","$fb09461e5f4fdf78$var$onCloseModal","iframeContainer","trailerContainer","$cDXQO","handleBackButtonClick","close","trailerButtonRef","handleTrailerButtonClick","$fb09461e5f4fdf78$var$onCloseModalEsc","code","evt1","_target1","id","nodeName1","nodeName","name","dataCurrentFilm","getFilmData","modifyDataFilm","open","_target","key","changeStore","rerenderBtnWrapper","event","closest"],"version":3,"file":"index.2d7beb77.js.map"}